<link href="../styles.css" rel="stylesheet" />

## Введение в JavaScript

- [Введение в JavaScript](#введение-в-javascript)
  - [Что такое JavaScript](#что-такое-javascript)
    - [История JavaScript](#история-javascript)
    - [Применение JavaScript](#применение-javascript)
    - [Что может JavaScript в браузере?](#что-может-javascript-в-браузере)
    - [Чего НЕ может JavaScript в браузере?](#чего-не-может-javascript-в-браузере)
    - [Что делает JavaScript особенным?](#что-делает-javascript-особенным)
    - [Языки «над» JavaScript](#языки-над-javascript)
    - [Итого](#итого)
  - [Стандарты, справочники и спецификации](#стандарты-справочники-и-спецификации)
    - [Стандарты](#стандарты)
    - [Спецификация](#спецификация)
    - [Справочники](#справочники)
    - [Таблицы совместимости](#таблицы-совместимости)
  - [Инструментальные средства разработки](#инструментальные-средства-разработки)
    - [Редакторы кода](#редакторы-кода)
      - [IDE](#ide)
      - [«Лёгкие» редакторы](#лёгкие-редакторы)
    - [Выбор среды разработки](#выбор-среды-разработки)
    - [Интерпретаторы](#интерпретаторы)
      - [Инструменты разработчика](#инструменты-разработчика)
      - [Консоль браузера](#консоль-браузера)
        - [Google Chrome](#google-chrome)
        - [Firefox, Edge и другие](#firefox-edge-и-другие)
        - [Safari](#safari)
        - [Вывод на консоль](#вывод-на-консоль)
    - [Итого](#итого-1)
  - [Первая программа на JavaScript](#первая-программа-на-javascript)
    - [Подготовка](#подготовка)
    - [Создание страницы](#создание-страницы)
    - [Тег «script»](#тег-script)
    - [Современная разметка](#современная-разметка)
      - [Атрибут language](#атрибут-language)
      - [Атрибут type](#атрибут-type)
      - [Обёртывание скрипта в HTML-комментарии.](#обёртывание-скрипта-в-html-комментарии)
    - [Запуск программы](#запуск-программы)
    - [Выполнение кода](#выполнение-кода)
    - [Итого](#итого-2)
    - [Задачи](#задачи)
      - [Вызвать alert](#вызвать-alert)
      - [Покажите сообщение с помощью внешнего скрипта](#покажите-сообщение-с-помощью-внешнего-скрипта)
  - [Структура кода](#структура-кода)
    - [Инструкции](#инструкции)
      - [Точка с запятой](#точка-с-запятой)
    - [Блоки кода](#блоки-кода)
    - [Комментарии](#комментарии)
      - [Однострочные комментарии](#однострочные-комментарии)
      - [Многострочные комментарии](#многострочные-комментарии)
  - [Строгий режим — "use strict"](#строгий-режим--use-strict)
    - [«use strict»](#use-strict)
    - [Консоль браузера](#консоль-браузера-1)
    - [Всегда ли нужно использовать «use strict»?](#всегда-ли-нужно-использовать-use-strict)
  - [Взаимодействие с пользователем](#взаимодействие-с-пользователем)
    - [alert](#alert)
    - [prompt](#prompt)
    - [confirm](#confirm)
    - [Итого](#итого-3)
    - [Задачи](#задачи-1)
      - [Простая страница](#простая-страница)
  - [Внешние скрипты](#внешние-скрипты)
    - [Создание отдельного файла](#создание-отдельного-файла)
    - [Подключение внешнего файла](#подключение-внешнего-файла)
    - [Асинхронная загрузка и отложенное выполнение](#асинхронная-загрузка-и-отложенное-выполнение)
    - [Загрузка модулей](#загрузка-модулей)
  - [Источники информации](#источники-информации)

Давайте посмотрим, что такого особенного в JavaScript, чего можно достичь с его помощью и какие другие технологии хорошо с ним работают.

### Что такое JavaScript
Изначально *JavaScript* был создан, чтобы «*сделать веб-страницы живыми*».

Сегодняшний мир веб-сайтов трудно представить без языка JavaScript. JavaScript — это то, что делает живыми веб-страницы, которые мы каждый день просматриваем в своем веб-браузере.[^1-1]

Программы на этом языке называются <dfn title="скрипт">скриптами</dfn> или <dfn title="сценарий">сценариями</dfn> (*scripts*). Они могут встраиваться в HTML и выполняться автоматически при загрузке веб-страницы.

Скрипты распространяются и выполняются, как простой текст. Им не нужна специальная подготовка или компиляция для запуска.

Это отличает JavaScript от другого языка с похожим названием – [Java](https://ru.wikipedia.org/wiki/Java).

!!! info "Почему JavaScript?"
    Когда JavaScript создавался, у него было другое имя – «LiveScript». Однако, язык Java был очень популярен в то время, и было решено, что позиционирование JavaScript как «младшего брата» Java будет полезно.

    Со временем JavaScript стал полностью независимым языком со своей собственной спецификацией, называющейся [ECMAScript](https://ru.wikipedia.org/wiki/ECMAScript), и сейчас не имеет никакого отношения к Java.

Таким образом, JavaScript является интерпретируемым языком. Это значит, что код на языке JavaScript выполняется с помощью интерпретатора. Интерпретатор получает инструкции языка JavaScript, которые определены на веб-странице, выполняет их (или интерпретирует).

Сегодня JavaScript может выполняться не только в браузере, но и на сервере или на любом другом устройстве, которое имеет специальную программу, называющуюся [«движком» JavaScript](https://ru.wikipedia.org/wiki/%D0%94%D0%B2%D0%B8%D0%B6%D0%BE%D0%BA_JavaScript).

У браузера есть собственный движок, который иногда называют «виртуальная машина JavaScript».

Разные движки имеют разные «кодовые имена». Например:

- [V8](https://ru.wikipedia.org/wiki/V8_(%D0%B4%D0%B2%D0%B8%D0%B6%D0%BE%D0%BA_JavaScript)) – в Chrome, Opera и Edge.
- [SpiderMonkey](https://ru.wikipedia.org/wiki/SpiderMonkey) – в Firefox.
…Ещё есть «Chakra» для IE, «JavaScriptCore», «Nitro» и «SquirrelFish» для Safari и т.д.

Эти названия полезно знать, так как они часто используются в статьях для разработчиков. Мы тоже будем их использовать. Например, если «функциональность X поддерживается V8», тогда «Х», скорее всего, работает в Chrome, Opera и Edge.

!!! info "Как работают движки?"

    Движки сложны. Но основы понять легко.

    1. Движок (встроенный, если это браузер) читает («парсит») текст скрипта.
    2. Затем он преобразует («компилирует») скрипт в машинный язык.
    3. После этого машинный код запускается и работает достаточно быстро.

    Движок применяет оптимизации на каждом этапе. Он даже просматривает скомпилированный скрипт во время его работы, анализируя проходящие через него данные, и применяет оптимизации к машинному коду, полагаясь на полученные знания. В результате скрипты работают очень быстро.

#### История JavaScript
Сегодняшний мир веб-сайтов трудно представить без языка JavaScript. JavaScript — это то, что делает живыми веб-страницы, которые мы каждый день просматриваем в своем веб-браузере.

JavaScript был создан в 1995 году в компании Netscape разработчиком Брендоном Айком (Brendon Eich) в качестве языка сценариев в браузере Netscape Navigator 2. Первоначально язык назывался LiveScript, но на волне популярности в тот момент другого языка Java LiveScript был переименован в JavaScript. Однако данный момент до сих пор иногда приводит к некоторой путанице: некоторые начинающие разработчики считают, что Java и JavaScript чуть ли не один и тот же язык. Нет, это абсолютно два разных языка, и они связаны только по названию.[^1-1]

#### Применение JavaScript

Первоначально JavaScript обладал довольно небольшими возможностями. Его цель состояла лишь в том, чтобы добавить немного поведения на веб-страницу. Например, обработать нажатие кнопок на веб-странице, произвести какие-нибудь другие действия, связанные прежде всего с элементами управления.

Однако развитие веб-среды, появление HTML5 и технологии Node.js открыло перед JavaScript гораздо большие горизонты. Сейчас JavaScript продолжает использоваться прежде всего для создания веб-приложений на стороне клиента, только теперь он предоставляет гораздо больше возможностей.

Также он применяется как язык серверной стороны. То есть если раньше JavaScript применялся только на веб-странице, а на стороне сервера нам надо было использовать такие технологии, как PHP, ASP.NET, Ruby, Java, то сейчас благодаря Node.js мы можем обрабатывать все запросы к серверу также с помощью JavaScript.

Также JavaScript может применяться для создания десктопных приложений, например, благодаря таким фреймворкам как Electron.

В последнее время переживает бум сфера мобильной разработки. И JavaScript опять же не остается в стороне: увеличение мощности устройств и повсеместное распространение стандарта HTML5 привело к тому, что для создания приложений для смартфонов, планшетов и настольных компьютеров мы также можем использовать JavaScript. То есть JavaScript уже перешагнул границы веб-браузера, которые ему были очерчены при его создании.

Также javascript может использоваться для разработки программ для встроенных устройство, в частности, для направления IoT(Internet of Things или Интернет вещей). То есть JavaScript можно использовать для программирования самых различных "умных" устройств, которые взаимодействуют с интернетом.

Таким образом, вы можете встретить применение JavaScript практически повсюду. Сегодня это действительно один из самых популярных языков программирования, и его популярность еще будет расти.[^1-1]

#### Что может JavaScript в браузере?
Современный JavaScript – это «безопасный» язык программирования. Он не предоставляет низкоуровневый доступ к памяти или процессору, потому что изначально был создан для браузеров, не требующих этого.

Возможности JavaScript сильно зависят от окружения, в котором он работает. Например, [Node.js](https://ru.wikipedia.org/wiki/Node.js) поддерживает функции чтения/записи произвольных файлов, выполнения сетевых запросов и т.д.

В браузере для JavaScript доступно всё, что связано с манипулированием веб-страницами, взаимодействием с пользователем и веб-сервером.

Например, в браузере JavaScript может:

- Добавлять новый HTML-код на страницу, изменять существующее содержимое, модифицировать стили.
- Реагировать на действия пользователя, щелчки мыши, перемещения указателя, нажатия клавиш.
- Отправлять сетевые запросы на удалённые сервера, скачивать и загружать файлы (технологии [AJAX](https://ru.wikipedia.org/wiki/AJAX) и [COMET](https://ru.wikipedia.org/wiki/Comet_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5))).
- Получать и устанавливать куки, задавать вопросы посетителю, показывать сообщения.
- Запоминать данные на стороне клиента («local storage»).

#### Чего НЕ может JavaScript в браузере?
*[HTTP]: HyperText Transfer Protocol

Возможности JavaScript в браузере ограничены ради безопасности пользователя. Цель заключается в предотвращении доступа недобросовестной веб-страницы к личной информации или нанесения ущерба данным пользователя.

Примеры таких ограничений включают в себя:

- JavaScript на веб-странице не может читать/записывать произвольные файлы на жёстком диске, копировать их или запускать программы. Он не имеет прямого доступа к системным функциям ОС.

- Современные браузеры позволяют ему работать с файлами, но с ограниченным доступом, и предоставляют его, только если пользователь выполняет определённые действия, такие как «перетаскивание» файла в окно браузера или его выбор с помощью тега `<input>`.

- Существуют способы взаимодействия с камерой/микрофоном и другими устройствами, но они требуют явного разрешения пользователя. Таким образом, страница с поддержкой JavaScript не может незаметно включить веб-камеру, наблюдать за происходящим и отправлять информацию в какую-нибудь службу безопасности.

- Различные окна/вкладки не знают друг о друге. Иногда одно окно, используя JavaScript, открывает другое окно. Но даже в этом случае JavaScript с одной страницы не имеет доступа к другой, если они пришли с разных сайтов (с другого домена, протокола или порта).

    Это называется «Политика одинакового источника» (*Same Origin Policy*). Чтобы обойти это ограничение, обе страницы должны согласиться с этим и содержать JavaScript-код, который специальным образом обменивается данными.

    Это ограничение необходимо, опять же, для безопасности пользователя. Страница https://anysite.com, которую открыл пользователь, не должна иметь доступ к другой вкладке браузера с URL https://gmail.com и воровать информацию оттуда.

- JavaScript может легко взаимодействовать с сервером, с которого пришла текущая страница. Но его способность получать данные с других сайтов/доменов ограничена. Хотя это возможно в принципе, для чего требуется явное согласие (выраженное в заголовках HTTP) с удалённой стороной. Опять же, это ограничение безопасности

<figure>

![Limitations](../svg/limitations.svg)

</figure>

Подобные ограничения не действуют, если JavaScript используется вне браузера, например — на сервере. Современные браузеры предоставляют плагины/расширения, с помощью которых можно запрашивать дополнительные разрешения.

#### Что делает JavaScript особенным?
Как минимум, три сильные стороны JavaScript:

- Полная интеграция с HTML/CSS.
- Простые вещи делаются просто.
- Поддерживается всеми основными браузерами и включён по умолчанию.

JavaScript – это единственная браузерная технология, сочетающая в себе все эти три вещи.

Вот что делает JavaScript особенным. Вот почему это самый распространённый инструмент для создания интерфейсов в браузере.

Хотя, конечно, JavaScript позволяет делать приложения не только в браузерах, но и на сервере, на мобильных устройствах и т.п.

#### Языки «над» JavaScript
Синтаксис JavaScript подходит не под все нужды. Разные люди хотят иметь разные возможности.

Это естественно, потому что проекты разные и требования к ним тоже разные.

Так, в последнее время появилось много новых языков, которые *транспилируются* (конвертируются) в JavaScript, прежде чем запустятся в браузере.

Современные инструменты делают транспиляцию очень быстрой и прозрачной, фактически позволяя разработчикам писать код на другом языке, автоматически преобразуя его в JavaScript «под капотом».

Примеры таких языков:

- [CoffeeScript](https://coffeescript.org/) добавляет «синтаксический сахар» для JavaScript. Он вводит более короткий синтаксис, который позволяет писать чистый и лаконичный код. Обычно такое нравится Ruby-программистам.
- [TypeScript](https://www.typescriptlang.org/) концентрируется на добавлении «строгой типизации» для упрощения разработки и поддержки больших и сложных систем. Разработан Microsoft.
- [Flow](https://flow.org/) тоже добавляет типизацию, но иначе. Разработан Facebook.
- [Dart](https://www.dartlang.org/) стоит особняком, потому что имеет собственный движок, работающий вне браузера (например, в мобильных приложениях). Первоначально был предложен Google, как замена JavaScript, но на данный момент необходима его транспиляция для запуска так же, как для вышеперечисленных языков.
- [Brython](https://brython.info/) транспилирует Python в JavaScript, что позволяет писать приложения на чистом Python без JavaScript.

Есть и другие. Но даже если мы используем один из этих языков, мы должны знать JavaScript, чтобы действительно понимать, что мы делаем.[^intro]

#### Итого
- JavaScript изначально создавался только для браузера, но сейчас используется на многих других платформах.
- Сегодня JavaScript занимает уникальную позицию в качестве самого распространённого языка для браузера, обладающего полной интеграцией с HTML/CSS.
- Многие языки могут быть «транспилированы» в JavaScript для предоставления дополнительных функций. Рекомендуется хотя бы кратко рассмотреть их после освоения JavaScript.

### Стандарты, справочники и спецификации

#### Стандарты
*[ECMA]: European Computers Manufactures Association

С самого начала существовало несколько веб-браузеров (Netscape, Internet Explorer), которые предоставляли различные реализации языка. И чтобы свести различные реализации к общему стержню и стандартизировать язык под руководством организации ECMA (European Computers Manufactures Association — Европейская Ассоциация Производителей Компьютеров) был разработан стандарт ECMAScript. В принципе сами термины JavaScript и ECMAScript являются во многом взаимозаменяемыми и относятся к одному и тому же языку.

К настоящему времени ECMA было разработано несколько стандартов языка, которые отражают его развитие. В последнее время почти каждый год выходит новый стандарт. На данный момент последним принятым стандартом является ECMAScript 2023, который был издан в июне 2023 года. В последние годы новые стандарты выпускаются почти каждый год, понемногу добавляя новые возможности к языку. Однако реализация стандартов в браузерах занимает довольно продолжительное время. Одни браузеры быстрее реализуют новые стандарты, другие медленнее. Кроме того, есть большой пласт старых версий браузеров, которыми простые пользователи продолжают пользоваться и которые естественно могут не поддерживать нововведения последних стандартов. И это надо учитывать при разработке программ на JavaScript. В данном же руководстве будут рассматриваться в основном те возможности JavaScript, которые поддерживаются всеми наиболее распространенными современными браузерами.

#### Спецификация
[Спецификация ECMA-262](https://www.ecma-international.org/publications-and-standards/standards/ecma-262/) содержит самую глубокую, детальную и формализованную информацию о JavaScript. Она определяет сам язык.

Вначале спецификация может показаться тяжеловатой для понимания из-за слишком формального стиля изложения. Если вы ищете источник самой достоверной информации, то это правильное место, но она не для ежедневного использования.

Новая версия спецификации появляется каждый год. А пока она не вышла официально, все желающие могут ознакомиться с текущим черновиком на https://tc39.es/ecma262/.

Чтобы почитать о самых последних возможностях, включая те, которые «почти в стандарте» (так называемые «stage 3 proposals»), посетите https://github.com/tc39/proposals.

Если вы разрабатываете под браузеры, то существуют и другие спецификации, посвященные специальным браузерными функциям.

#### Справочники
**MDN (Mozilla) JavaScript Reference** – это справочник с примерами и другой информацией. Хороший источник для получения подробных сведений о функциях языка, методах встроенных объектов и так далее.

Располагается по адресу https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference.

Хотя зачастую вместо их сайта удобнее использовать какой-нибудь интернет-поисковик, вводя там запрос «MDN [что вы хотите найти]», например https://google.com/search?q=MDN+parseInt для поиска информации о функции `parseInt`.

#### Таблицы совместимости
JavaScript – это развивающийся язык, в который постоянно добавляется что-то новое.

Посмотреть, какие возможности поддерживаются в разных браузерах и других движках, можно в следующих источниках:

- https://caniuse.com – таблицы с информацией о поддержке по каждой возможности языка. Например, чтобы узнать, какие движки поддерживают современные криптографические функции, посетите: https://caniuse.com/#feat=cryptography.
- https://kangax.github.io/compat-table – таблица с возможностями языка и движками, которые их поддерживают и не поддерживают.

Все эти ресурсы полезны в ежедневной работе программиста, так как они содержат ценную информацию о возможностях использования языка, их поддержке и так далее.

Пожалуйста, запомните эти ссылки (или ссылку на эту страницу) на случай, когда вам понадобится подробная информация о какой-нибудь конкретной возможности JavaScript.[^manuals-specifications]

### Инструментальные средства разработки
Для разработки на JavaScript потребуется текстовый редактор для написания кода на данном языке программирования, а для выполнения программы и проверки результатов — интерпретатор JavaScript, который встроен во все современные веб-браузеры, а также составляющий основу в серверной среды разработки Node.js.

#### Редакторы кода
*[IDE]: Integrated Development Environment
Большую часть своего рабочего времени программисты проводят в редакторах кода.

Есть два основных типа редакторов: IDE и «лёгкие» редакторы. Многие используют по одному инструменту каждого типа.

##### IDE
Термином [IDE](https://ru.wikipedia.org/wiki/Integrated_development_environment) (Integrated Development Environment, «интегрированная среда разработки») называют мощные редакторы с множеством функций, которые работают в рамках целого проекта. Как видно из названия, это не просто редактор, а нечто большее.

IDE загружает проект (который может состоять из множества файлов), позволяет переключаться между файлами, предлагает автодополнение по коду всего проекта (а не только открытого файла), также она интегрирована с системой контроля версий (например, такой как [git](https://git-scm.com/)), средой для тестирования и другими инструментами на уровне всего проекта.

Если вы ещё не выбрали себе IDE, присмотритесь к этим:

- [Visual Studio Code](https://code.visualstudio.com/) (кросс-платформенная, бесплатная).
- [WebStorm](https://www.jetbrains.com/webstorm/) (кросс-платформенная, бесплатная для некоммерческого использования).

В качестве текстового редактора обычно советуют использовать **[Visual Studio Code](https://code.visualstudio.com/download)**. Он бесплатен, имеет много возможностей, в частности, поддерживает подцветку синтаксиса JavaScript и является кроссплатформенным: может быть установлен как на Windows, так и на Linux и MacOS. Хотя этот может быть любой другой текстовый редактор.

Для Windows есть ещё **Visual Studio** (не путать с Visual Studio Code). Visual Studio – это платная мощная среда разработки, которая работает только на Windows. Она хорошо подходит для .NET платформы. У неё есть бесплатная версия, которая называется [Visual Studio Community](https://www.visualstudio.com/vs/community/).

Многие IDE платные, но у них есть пробный период (как у **WebStorm**). Их цена обычно незначительна по сравнению с зарплатой квалифицированного разработчика, так что пробуйте и выбирайте ту, что вам подходит лучше других.

##### «Лёгкие» редакторы
«Лёгкие» редакторы менее мощные, чем IDE, но они отличаются скоростью, удобным интерфейсом и простотой.

В основном их используют для того, чтобы быстро открыть и отредактировать нужный файл.

Главное отличие между «лёгким» редактором и IDE состоит в том, что IDE работает на уровне целого проекта, поэтому она загружает больше данных при запуске, анализирует структуру проекта, если это необходимо, и так далее. Если вы работаете только с одним файлом, то гораздо быстрее открыть его в «лёгком» редакторе.

На практике «лёгкие» редакторы могут иметь множество плагинов, включая автодополнение и анализаторы синтаксиса на уровне директории, поэтому границы между IDE и «лёгкими» редакторами размыты.

Следующие варианты заслуживают вашего внимания:

- [Sublime Text](https://www.sublimetext.com/) (кроссплатформенный, условно-бесплатный).
- [Notepad++](https://notepad-plus-plus.org/) (Windows, бесплатный).
- [Vim](https://www.vim.org/) и [Emacs](https://www.gnu.org/software/emacs/) тоже хороши, если знать, как ими пользоваться.

#### Выбор среды разработки
Редакторы, перечисленные выше, известны разработчикам давно и заслужили много хороших отзывов от профессионалов. Конечно же, есть много других отличных редакторов. Существуют различные среды разработки, которые поддерживают JavaScript и облегчают разработку на этом языке, например, Visual Studio, WebStorm, Netbeans и так далее, которые могут упростить какие-то моменты создания программ на JavaScript. При желании можно использовать эти среды разработки.

Выбирайте тот, который вам больше нравится. Выбор редактора, как и любого другого инструмента, индивидуален и зависит от ваших проектов, привычек и личных предпочтений.[^code-editors] Однако в общем случае достаточно текствого редактора и веб-браузера, а в простых случаях даже достаточно одного браузера.

#### Интерпретаторы
Для проверки выполнения программы нам потребуется также интерпретатор JavaScript, который можем выполнять программы JavaScript. В качестве интерпретатора мы будем использовать стандартный веб-браузер. Можно использовать последние версии любых распространенных браузеров — Google Chrome, Microsoft Edge, Mozilla Firefox, Opera, Safari.

##### Инструменты разработчика
Код уязвим для ошибок. И любой разработчик, скорее всего, будет делать ошибки в коде… Но по умолчанию в браузере ошибки не видны. То есть, если что-то пойдёт не так, мы не увидим, что именно сломалось, и не сможем это починить.

Для решения задач такого рода в браузер встроены так называемые «Инструменты разработки» (**Developer tools** или сокращённо — **devtools**).

Chrome и Firefox снискали любовь подавляющего большинства программистов во многом благодаря своим отменным инструментам разработчика. Остальные браузеры, хотя и оснащены подобными инструментами, но всё же зачастую находятся в роли догоняющих и по качеству, и по количеству свойств и особенностей. В общем, почти у всех программистов есть свой «любимый» браузер. Другие используются только для отлова и исправления специфичных «браузерозависимых» ошибок.

Для начала знакомства с этими мощными инструментами давайте выясним, как их открывать, смотреть ошибки и запускать команды JavaScript.

##### Консоль браузера
Незаменимым инструментом при работе с JavaScript является консоль браузера, которая позволяет производить отладку программы. Во многих современных браузерах есть подобная консоль. Например, чтобы открыть консоль в Google Chrome, нам надо перейти в меню **Дополнительные инструменты** (**More Tools**) -> **Инструменты разработчика** (**Developer tools**):

![Отладка JavaScript в Google Chrome](../img/1.8.png)

После этого внизу браузера откроется консоль:

![Консоль JavaScript в Google Chrome](../img/1.9.png)

Мы можем напрямую вводить в консоль браузера выражения JavaScript, и они будут выполняться. Например, введем в консоли следующий текст:
```js
alert("Привет мир");
```

И что замечательно при работе с консолью, при вводе она предлагает всплывающую подсказку с названиями, которые мы хотим ввести, что упрощает ввод, снижает количество возможных ошибок:

![Консоль JavaScript в Google Chrome](../img/1.13.png)

Функция **`alert()`** выводит в браузере окно с сообщением. В итоге после ввода этой команды и нажатия на клавишу <kbd>Enter</kbd> браузер выполнит эту функцию и отобразит нам окно с сообщением:

![Ввод команд JavaScript в консоли браузера Google Chrome](../img/1.10.png)

Таким образом, для написания и выполнения кода JavaScript нам в принципе не нужен ни текстовый редактор, ни файл веб-страницы, который содержит код javascript, достаточно одной консоли браузера. Однако набирать большой и сложный код JavaScript в консоли может быть не очень удобно, поэтому в дальнейшем для всех примеров по прежнему будет использовать код JavaScript, который встраивается на html-страницу.

###### Google Chrome
Откройте страницу [bug.html](../samples/01_intro/bug.html).

В её JavaScript-коде закралась ошибка. Она не видна обычному посетителю, поэтому давайте найдём её при помощи инструментов разработки.

Нажмите <kbd>F12</kbd> или, если вы используете Mac, <kbd>Cmd</kbd>+<kbd>Opt</kbd>+<kbd>J</kbd>.

По умолчанию в инструментах разработчика откроется вкладка Console (консоль).

Она выглядит приблизительно следующим образом:

![Bug](../img/page-bug.png)

Точный внешний вид инструментов разработки зависит от используемой версии Chrome. Время от времени некоторые детали изменяются, но в целом внешний вид остаётся примерно похожим на предыдущие версии.

- В консоли мы можем увидеть сообщение об ошибке, отрисованное красным цветом. В нашем случае скрипт содержит неизвестную команду «lalala».
- Справа присутствует ссылка на исходный код `bug.html:12` с номером строки кода, в которой эта ошибка и произошла.

Под сообщением об ошибке находится синий символ `>`. Он обозначает командную строку, в ней мы можем редактировать и запускать JavaScript-команды. Для их запуска нажмите <kbd>⏎ Enter</kbd>.

!!! info "Многострочный ввод"
    Обычно при нажатии <kbd>⏎ Enter</kbd> введённая строка кода сразу выполняется.

    Чтобы перенести строку, нажмите <kbd>⇧ Shift</kbd>+<kbd>⏎ Enter</kbd>. Так можно вводить более длинный JS-код.

Теперь мы явно видим ошибки, для начала этого вполне достаточно. Мы ещё вернёмся к инструментам разработчика позже и более подробно рассмотрим отладку кода в главе [Отладка в браузере](https://learn.javascript.ru/debugging-chrome).

###### Firefox, Edge и другие
Инструменты разработчика в большинстве браузеров открываются при нажатии на <kbd>F12</kbd>.

Их внешний вид и принципы работы мало чем отличаются. Разобравшись с инструментами в одном браузере, вы без труда сможете работать с ними и в другом.

###### Safari
Safari (браузер для Mac, не поддерживается в системах Windows/Linux) всё же имеет небольшое отличие. Для начала работы нам нужно включить «Меню разработки» («Developer menu»).

Откройте Настройки (Preferences) и перейдите к панели «Продвинутые» (Advanced). В самом низу вы найдёте чекбокс:

![Safari](../img/safari@2x.png)

Теперь консоль можно активировать нажатием клавиш <kbd>Cmd</kbd>+<kbd>Opt</kbd>+<kbd>C</kbd>. Также обратите внимание на новый элемент меню «Разработка» («Develop»). В нем содержится большое количество команд и настроек.

###### Вывод на консоль
Для вывода различного рода информации в консоли браузера используется специальная функция **`console.log()`**. Например, определим html-страницу со следующим кодом:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" >
    <title>DevPM</title>
</head>
<body>
    <script>
        const sum = 5 + 8;
        console.log("Результат операции: ");
        console.log(sum);
    </script>
</body>
</html>
```

В коде javascript с помощью ключевого слова **`const`** объявляется константа `sum`, которой присваивается сумма двух чисел 5 и 8:
```js
const sum = 5 + 8;
```

Далее с помощью метода `console.log()` на консоль браузера выводится некоторое сообщение
```js
console.log("Результат операции");
```

И в конце также с помощью метода `console.log()` на консоль браузера выводится значение константы `sum`.

```js
console.log(sum);
```

И после запуска веб-страницы в браузере мы увидим в консоли результат выполнения кода:

![Функция console.log() в JavaScript](../img/1.11.png)

Что очень полезно, в консоли браузера вы также можете заметить номера строк кода, где именно выполнялся вывод на консоль.

В дальнейшем мы часто будем обращаться к консоли и использовать функцию `console.log`.

Причем подобный код мы могли бы ввести в самой консоли:

![Консоль JavaScript в браузере](../img/1.6.png)

Также последовательно вводим инструкции и после ввода каждой инструкции нажимаем на <kbd>Enter</kbd>. В данном случае я ввел две инструкции:
```js
const sum2 = 1 + 2      // определяем константу sum2, которая равна сумме 1 + 2
console.log(sum2)       // выводим значение константы sum2 на консоль
```

Если нам надо, чтобы код в консоли переносился на новую строку без выполнения, то в конце выражения javascript нажимаем на комбинацию клавиш <kbd>Shift</kbd> + <kbd>Enter</kbd>. После ввода последней инструкции для выполнения введенного кода javascript нажимаем на <kbd>Enter</kbd>.[^1-5]

Более подробно работа с инструментами разработчика и консолью в частности будет рассмотрена в разделе, посвященном качеству кода.

#### Итого
- Инструменты разработчика позволяют нам смотреть ошибки, выполнять команды, проверять значение переменных и ещё много всего полезного.
- В большинстве браузеров, работающих под Windows, инструменты разработчика можно открыть, нажав <kbd>F12</kbd>. В Chrome для Mac используйте комбинацию <kbd>Cmd</kbd>+<kbd>Opt</kbd>+<kbd>J</kbd>, Safari: <kbd>Cmd</kbd>+<kbd>Opt</kbd>+<kbd>C</kbd> (необходимо предварительное включение «Меню разработчика»).

Теперь наше окружение полностью настроено. В следующем разделе мы перейдём непосредственно к JavaScript.[^devtools]

### Первая программа на JavaScript
Итак, приступим к созданию первой программы. В этой части мы изучим собственно JavaScript, сам язык.

#### Подготовка

Создадим первую программу на javascript. Для написания и тестирования программ на JavaScript нам потребуются две вещи: текстовый редактор и веб-браузер.

В качестве текстового редактора можно взять любой, который нравится — Atom, Sublime Text, Visual Studio Code, Notepad++ и другие. В данном руководстве будем ориентироваться на бесплатный и многофункциональный текстовый редактор [Visual Studio Code](https://code.visualstudio.com/download), поскольку он является наиболее популярным.

Кроме того, нам потребуется рабочая среда для запуска наших скриптов, и браузер будет хорошим выбором. В качестве браузера также можно взять последние версии любого предпочтительного веб-браузера. В настоящем руководстве будем преимущественно ориентироваться на Google Chrome.

В данном разделе мы сократим количество специфичных для браузера команд (например, `alert`) до минимума, чтобы вы не тратили на них время, если планируете сосредоточиться на другой среде (например, Node.js). А на использовании JavaScript в браузере мы сосредоточимся в следующих частях.

Итак, сначала давайте посмотрим, как выполнить скрипт на странице. Для серверных сред (например, Node.js), вы можете выполнить скрипт с помощью команды типа "node my.js". Для браузера всё немного иначе.[^hello-world]

#### Создание страницы

Для начала определим для нашего приложения какой-нибудь каталог. Например, создадим на диске *C* папку *app*. В этой папке создадим файл под названием *index.html*. То есть данный файл будет представлять веб-страницу с кодом HTML.

![Первый скрипт на JavaScript](../img/1.12.png)

Откроем этот файл в текстовом редакторе и определим в файле следующий код:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        document.write("<h2>Первая программа на JavaScript</h2>");
    </script>
</body>
</html>
```

Здесь мы определяем стандартные элементы `html`. В элементе `head` определяется кодировка utf-8 и заголовок (элемент `title`). В элементе `body` определяется тело веб-страницы, которое в данном случае состоит только из одного элемента `<script>`.

#### Тег «script»
Программы на JavaScript могут быть вставлены в любое место HTML-документа с помощью тега `<script>`.

Для примера:
```html
<!DOCTYPE HTML>
<html>

<body>

  <p>Перед скриптом...</p>

  <script>
    alert( 'Привет, мир!' );
  </script>

  <p>...После скрипта.</p>

</body>

</html>
```

Итак, подключение кода javascript на html-страницу осуществляется с помощью тега `<script>`. Данный тег следует размещать либо в заголовке (между тегами `<head>` и `</head>`), либо в теле веб-странице (между тегами `<body>` и `</body>`). Нередко подключение скриптов происходит перед закрывающим тегом `</body>` для оптимизации загрузки веб-страницы.

Тег `<script>` содержит JavaScript-код, который автоматически выполнится, когда браузер его обработает.

#### Современная разметка
Тег `<script>` имеет несколько атрибутов, которые редко используются, но всё ещё могут встретиться в старом коде:

##### Атрибут language
Атрибут `language` теге `<script>` задавал тип скриптового языка, чтобы браузер правильно его обрабатывал. Данный атрибут использовался в ранних версиях HTML (до HTML5) для указания языка скрипта, такого как JavaScript или VBScript. Он помогал браузерам определять, как интерпретировать содержимое скрипта, например, `language="JavaScript"`. Основные используемые значения: "JavaScript", "JavaScript1.1", "VBScript", "JScript". По умолчанию подразумевался JavaScript, если атрибут отсутствовал

Спецификации HTML (с версии 4.01 и особенно HTML5) рекомендуют заменить `language` на атрибут `type`, который использует MIME-типы (например, `text/javascript`). Значения `language` никогда не были строго стандартизированы, что вызывало проблемы совместимости. Так как JavaScript является языком по умолчанию (альтернативные варианты языков уже давно вышли из употребления), в этом атрибуте уже нет необходимости. Большинство браузеров всё ещё поддерживают `language` для обратной совместимости со старым кодом, однако его использование приводит к ошибкам валидации HTML5 и не рекомендуется в новых проектах.

##### Атрибут type
*[CSP]: Content Security Policy
*[XSS]: Cross-Site Scripting
*[WAF]: Web Application Firewall

Раньше надо было в теге `<script>` указывать тип скрипта, так как данный тег может использоваться не только для подключения инструкций javascript, но и для других целей. Так, даже сейчас можно встретить на некоторых веб-страницах такое определение элемента `script`:
```html
<script type="text/javascript">
```

Старый стандарт HTML, HTML4, требовал наличия этого атрибута в теге `<script>`. В HTML4 и ранее `type` был обязательным атрибутом для указания языка скрипта через MIME-типы, заменив устаревший `language`. MIME-тип содержимого скрипта помогал браузеру определить, как интерпретировать сценарий. Основные значения были следующими: ` text/javascript` (JavaScript), `text/vbscript` (VBScript), `text/ecmascript`. Обычно данный атрибут имел значение `type="text/javascript"`. Это обеспечивало совместимость и правильную обработку в разных браузерах.

В HTML5 для классического JavaScript атрибут `type` не обязателен — по умолчанию подразумевается `text/javascript`. Соответственно, на текущий момент больше не требуется указывать конкретное значение, поэтому в настоящее время предпочтительнее опускать атрибут `type`, так как браузеры по умолчанию считают, что элемент `script` содержит инструкции `javascript`.

Более того, в современном стандарте HTML смысл этого атрибута полностью изменился. Теперь он может использоваться для JavaScript-модулей. Но это тема не для начального уровня, и о ней мы поговорим в другой части, касающейся модулей. Соответственно, в настоящее время данный атрибут обязателен для:

- модулей: `type="module" (ES6 модули)`;
​
- WebAssembly: `type="application/wasm"`.

- других языков или CSP-политик

<dfn title="Content Security Policy">Content Security Policy</dfn> (CSP) — это стандарт безопасности веб-приложений (HTTP-заголовок), позволяющий разработчикам ограничивать источники загрузки ресурсов (скриптов, стилей, изображений), что предотвращает XSS-атаки и внедрение вредоносного кода. Он создает «белый список» доверенных доменов, блокируя всё остальное.

**Основные аспекты CSP**:
- **Защита от XSS**: основная цель — предотвращение выполнения сторонних скриптов, кражи данных и подмены страниц.
- **Принцип работы**: настройка осуществляется через заголовок `Content-Security-Policy` на сервере.
- **Директивы**: `default-src` (по умолчанию), `script-src` (скрипты), `style-src` (стили) определяют, откуда можно загружать контент.
- **`Report-Only`**: Режим `Content-Security-Policy-Report-Only` позволяет тестировать политики без реальной блокировки ресурсов.

<dfn title="межсайтовый скриптинг">Межсайтовый скриптинг</dfn> (XSS) — это тип уязвимости веб-приложений, при которой злоумышленник внедряет вредоносный JavaScript-код на страницу, выполняемый в браузере пользователя. Это позволяет красть сессионные cookie, подменять контент, перенаправлять на фишинговые сайты и получать доступ к личным данным. Основные типы включают хранимый, отраженный и DOM-based XSS.

**Основные типы XSS-атак**:
- **Хранимый (Stored/Persistent) XSS**: вредоносный скрипт постоянно хранится на сервере (например, в базе данных комментариев) и выполняется у каждого пользователя, посещающего страницу.
- **Отраженный (Reflected) XSS**: скрипт передается через URL или параметры запроса и «отражается» сервером, выполняясь при переходе по ссылке.
- **DOM-based XSS**: Вредоносный код изменяет структуру DOM-модели страницы в браузере жертвы, не взаимодействуя с сервером напрямую.

XSS-атаки могут привести к полному захвату учетной записи пользователя. Основной метод защиты — фильтрация, экранирование (*escaping*) пользовательского ввода и использование безопасных методов отображения данных (например, `innerText` вместо `innerHTML`). Использование межсетевых экранов веб-приложений (WAF) помогает выявлять и блокировать типичные XSS-пейлоады.

Таким образом, все браузеры поддерживают `type`, но его отсутствие упрощает код без потери функциональности. В HTML5 для JavaScript атрибут `type` можно опускать полностью, так как он подразумевается по умолчанию.

##### Обёртывание скрипта в HTML-комментарии.
В очень древних книгах и руководствах вы сможете найти комментарии внутри тега `<script>`, например, такие:
```js
<script type="text/javascript"><!--
    ...
//--></script>
```

Этот комментарий скрывал код JavaScript в старых браузерах, которые не знали, как обрабатывать тег `<script>`. Поскольку все браузеры, выпущенные за последние 15 лет, не содержат данной проблемы, такие комментарии уже не нужны. Если они есть, то это признак, что перед нами очень древний код.

#### Запуск программы

Используемый нами выше код javascript содержит одно выражение:
```js
document.write("<h2>Первая программа на JavaScript</h2>");
```

Код javascript может содержать множество инструкций и каждая инструкция завершается точкой с запятой. Наша инструкция вызывает метод `document.write()`, который выводит на веб-страницу некоторое содержимое, в данном случае это заголовок `<h2>Первая программа на JavaScript</h2>`.

Вид файла в текстовом редакторе Visual Studio Code:

![Первая программа на JavaScript в Visual Studio Code](../img/1.2.png)

Теперь, когда веб-страница готова, откроем ее в веб-браузере.

![Первая программа на JavaScript](../img/1.1.png)

И веб-браузер отобразит заголовок, который мы передали в метод `document.write()` в коде javascript.[^1.2]

#### Выполнение кода

Когда браузер получает веб-страницу с кодом html и javascript, то он ее интерпретирует. Результат интерпретации в виде различных элементов — кнопок, полей ввода, текстовых блоков и т.д., мы видим перед собой в браузере. Интерпретация веб-страницы происходит последовательно сверху вниз.

Когда браузер встречает на веб-странице элемент `<script>` с кодом javascript, то вступает в действие встроенный интерпретатор javascript. И пока он не закончит свою работу, дальше интерпретация веб-страницы не идет.

Рассмотрим небольшой пример и для этого определим файл *index.html* со следующим кодом:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
    <script>
        document.write("Начальный текст");
    </script>
</head>
<body>
    <h2>Первый заголовок</h2>
    <script>
        document.write("Первый текст");
    </script>
    <h2>Второй заголовок</h2>
    <script>
        document.write("Второй текст");
    </script>
</body>
</html>
```

Здесь три вставки кода javascript — один в секции `<head>` и по одному после каждого заголовка.

Откроем веб-страницу в браузере и мы увидим, что браузер последовательно выполняет код веб-страницы:

![Интерпретация кода JavaScript](../img/1.4.png)

Здесь мы видим, что вначале выполняется код javascript из секции `head`, который выводит на веб-страницу некоторый текст:
```js
document.write("Начальный текст");
```

Далее выводится первый стандартный html-элемент `<h2>`:
```html
<h2>Первый заголовок</h2>
```

После этого выполняется вторая вставка кода на javascript:
```js
document.write("Первый текст");
```

Затем выводится второй html-элемент `<h2>`:
```html
<h2>Второй заголовок</h2>
```

И в конце выполняется последняя вставка кода на javascript:
```js
document.write("Второй текст");
```

После этого браузер закончит интерпретацию веб-страницы, и веб-страница окажется полностью загружена. Данный момент очень важен, поскольку может влиять на производительность. Поэтому нередко вставки кода javascript идут перед закрывающим тегом `</body>`, когда основная часть веб-страницы уже загружена в браузере.[^1.3]

#### Итого
- Для добавления кода JavaScript на страницу используется тег `<script>`
- Атрибуты `type` и `language` необязательны.
- Скрипт во внешнем файле можно вставить с помощью `<script src="path/to/script.js"></script>`.

Нам ещё многое предстоит изучить про браузерные скрипты и их взаимодействие со страницей. Но, как уже было сказано, эта часть учебника посвящена именно языку JavaScript, поэтому здесь мы постараемся не отвлекаться на детали реализации в браузере. Мы воспользуемся браузером для запуска JavaScript, это удобно для онлайн-демонстраций, но это только одна из платформ, на которых работает этот язык.[^hello-world]

#### Задачи

##### Вызвать alert

Создайте страницу, которая отобразит сообщение «Я JavaScript!».

Выполните это задание в песочнице, либо на вашем жёстком диске, где – неважно, главное – проверьте, что она работает.

<details>
<summary>Решение</summary>

```html
<!DOCTYPE html>
<html>
<body>

  <script>
    alert( "Я JavaScript!" );
  </script>

</body>
</html>
```

</details>

##### Покажите сообщение с помощью внешнего скрипта

Возьмите решение предыдущей задачи Вызвать `alert`, и измените его. Извлеките содержимое скрипта во внешний файл *alert.js*, лежащий в той же папке.

Откройте страницу, убедитесь, что оповещение работает.[^hello-world]


<details>
<summary>Решение</summary>

HTML-код:
```html
<!DOCTYPE html>
<html>

<body>

  <script src="alert.js"></script>

</body>

</html>
```

Для файла *alert.js* в той же папке:
```js
alert("Я JavaScript!");
```

</details>

### Структура кода
Прежде чем переходить к детальному изучению основ языка программирования javascript, следует познакомиться с некоторыми базовыми моментами его синтаксиса. Начнём изучение языка с рассмотрения основных «строительных блоков» кода.[^structure]

#### Инструкции

Код javascript состоит из инструкций. <dfn title="инструкция">Инструкции</dfn> (*statement*) – это синтаксические конструкции и команды, которые выполняют действия.

Мы уже видели инструкцию `alert('Привет, мир!')`, которая отображает сообщение «Привет, мир!».

Каждая инструкция представляет некоторое действие, а поскольку количество действий в принципе не ограничено, то в коде может быть столько инструкций, сколько необходимо. Инструкции могут отделяться точкой с запятой.

Например, здесь мы разделили сообщение «Привет Мир» на два вызова `alert`:
```js
alert('Привет'); alert('Мир');
```

Обычно каждую инструкцию пишут на новой строке, чтобы код было легче читать:
```js
alert('Привет');
alert('Мир');
```

##### Точка с запятой
Для отделения инструкций друг от друга в javascript после инструкции ставится точка с запятой:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        document.write("2 + 5 =  "); const sum = 2 + 5; document.write(sum);
    </script>
</body>
</html>
```

Здесь в коде javascript определены три инструкции:

1. `document.write("2 + 5 =  ")`

    Выводит на страницу текст "2 + 5 = "

2. `const sum = 2 + 5;`

    С помощью оператора `const` определяет константу `sum` — некоторое значение, которое не должно меняться (так как в данном случае мы присваиваем ему значение только один раз и больше не изменяем). И эта константа равна сумме 2 + 5

3. `document.write(sum);`

    Выводит на страницу значение константы `sum` (то есть суму 2 + 5)

    ![Инструкции в JavaScript](../img/1.5.png)

Однако современные браузеры вполне могут различать отдельные инструкции, если они просто располагаются на отдельных строках без точки запятой:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        document.write("2 + 5 =  ")
        const sum = 2 + 5
        document.write(sum)
    </script>
</body>
</html>
```

Таким образом, в большинстве случаев точку с запятой можно не ставить, если есть переход на новую строку.

Так тоже будет работать:
```js
alert('Привет')
alert('Мир')
```

В этом случае JavaScript интерпретирует перенос строки как «неявную» точку с запятой. Это называется [автоматическая вставка точки с запятой](https://tc39.github.io/ecma262/#sec-automatic-semicolon-insertion).

**В большинстве случаев новая строка подразумевает точку с запятой. Но «в большинстве случаев» не значит «всегда»!**

В некоторых ситуациях новая строка всё же не означает точку с запятой. Например:
```js
alert(3 +
1
+ 2);
```

Код выведет `6`, потому что JavaScript не вставляет здесь точку с запятой. Интуитивно очевидно, что, если строка заканчивается знаком "+", значит, это «незавершённое выражение», поэтому точка с запятой не требуется. И в этом случае всё работает, как задумано.

**Но есть ситуации, где JavaScript «забывает» вставить точку с запятой там, где она нужна.**

Ошибки, которые при этом появляются, достаточно сложно обнаруживать и исправлять.

!!! info "Пример ошибки"
    Если вы хотите увидеть конкретный пример такой ошибки, обратите внимание на этот код:
    ```js
    alert('Hello');

    [1, 2].forEach(alert);
    ```

    Пока нет необходимости знать значение скобок `[]` и `forEach`. Мы изучим их позже. Пока что просто запомните результат выполнения этого кода: выводится `Hello`, затем `1`, затем `2`.

    А теперь давайте уберем точку с запятой после `alert`:
    ```js
    alert('Hello')

    [1, 2].forEach(alert);
    ```

    Этот код отличается от кода, приведенного выше, только в одном: пропала точка с запятой в конце первой строки.

    Если мы запустим этот код, выведется только первый `alert`, а затем мы получим ошибку (вам может потребоваться открыть консоль, чтобы увидеть её)!

    Это потому что JavaScript не вставляет точку с запятой перед квадратными скобками `[...]`. И поэтому код в последнем примере выполняется, как одна инструкция.

    Вот как движок видит его:
    ```js
    alert('Hello')[1, 2].forEach(alert);
    ```

    Выглядит странно, правда? Такое слияние в данном случае неправильное. Мы должны поставить точку с запятой после `alert`, чтобы код работал правильно.

    Это может произойти и в некоторых других ситуациях.

> Чтобы улучшить читабельность кода и снизить число возможных ошибок, рекомендуется определять каждую инструкцию javascript на отдельной строчке и завершать ее точкой с запятой, как в первом варианте.

Таким образом, рекомендуется ставить точку с запятой между инструкциями, даже если они отделены переносами строк. Это правило широко используется в сообществе разработчиков. Стоит отметить ещё раз – в большинстве случаев можно не ставить точку с запятой. Но безопаснее, особенно для новичка, ставить её.

#### Блоки кода
Отдельные инструкции можно можно объединять в блоки кода, которые представляют некоторый код, заключенные между фигурными скобками `{ блок кода }`. Например, определим следующую страницу:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        document.write("Привет! ");
        {
            document.write("Как дела? ");
            document.write("Че не отвечаешь, ты че спишь? ");
        }
        document.write("Ну пока...");
    </script>
</body>
</html>
```

Здесь программа на JavaScript состоит из 4-х инструкций. Причем две из инструкций помещены в блок кода:
```js
{
    document.write("Как дела? ");
    document.write("Че не отвечаешь, ты че спишь? ");
}
```

Одна инструкция выполняется до блока кода, и еще одна — после блока кода.[^1.4]

#### Комментарии
Со временем программы становятся всё сложнее и сложнее. Возникает необходимость добавлять *комментарии*, которые бы описывали, что делает код и почему.

В коде javascript могут использоваться комментарии. Комментарии не обрабатываются интерпретатором javascript и никак не учитываются в работе программы. Они предназначены для ориентации по коду, чтобы указать, что делает тот или иной код.[^1.3]

Комментарии могут находиться в любом месте скрипта. Они не влияют на его выполнение, поскольку движок просто игнорирует их.

##### Однострочные комментарии

Комментарии могут быть однострочными:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        // выводим сообщение
        document.write("2 + 5 =  ")
        // объявляем константу и присваиваем ей сумму чисел 2 и 5
        const sum = 2 + 5
        // выводим значение константы sum
        document.write(sum)
    </script>
</body>
</html>
```

**Однострочные комментарии начинаются с двойной косой черты `//`.**

Часть строки после `//` считается комментарием. Такой комментарий может как занимать строку целиком, так и находиться после инструкции.

Как здесь:
```js
// Этот комментарий занимает всю строку
alert('Привет');

alert('Мир'); // Этот комментарий следует за инструкцией
```

##### Многострочные комментарии

Кроме однострочных комментариев могут использоваться и многострочные:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script>
        /*  Пример арифметической операции
        и определения константы
        в коде JavaScript */
        document.write("2 + 5 =  ")
        const sum = 2 + 5
        document.write(sum)
    </script>
</body>
</html>
```

**Многострочные комментарии начинаются косой чертой со звёздочкой `/*` и заканчиваются звёздочкой с косой чертой `*/`.**

Как вот здесь:
```js
/* Пример с двумя сообщениями.
Это - многострочный комментарий.
*/
alert('Привет');
alert('Мир');
```

Содержимое комментария игнорируется, поэтому, если мы поместим код внутри `/* … */`, он не будет исполняться.

Это бывает удобно для временного отключения участка кода:
```js
/* Закомментировали код
alert('Привет');
*/
alert('Мир');
```

!!! info "Используйте горячие клавиши!"
    В большинстве редакторов строку кода можно закомментировать, нажав комбинацию клавиш <kbd>Ctrl</kbd>+<kbd>/</kbd> для однострочного комментария и что-то вроде <kbd>Ctrl</kbd>+<kbd>⇧ Shift</kbd>+<kbd>/</kbd> – для многострочных комментариев (выделите кусок кода и нажмите комбинацию клавиш). В системе Mac попробуйте <kbd>Cmd</kbd> вместо <kbd>Ctrl</kbd> и <kbd>Option</kbd> вместо <kbd>⇧ Shift</kbd>.

!!! warning "Вложенные комментарии не поддерживаются!"
    Не может быть `/*...*/` внутри `/*...*/`.

    Такой код «умрёт» с ошибкой:
    ```js
    /*
      /* вложенный комментарий ?!? */
    */
    alert( 'Мир' );
    ```

Не стесняйтесь использовать комментарии в своём коде.

Комментарии увеличивают размер кода, но это не проблема. Есть множество инструментов, которые минифицируют код перед публикацией на рабочий сервер. Они убирают комментарии, так что они не содержатся в рабочих скриптах. Таким образом, комментарии никоим образом не вредят рабочему коду.

Как лучше писать комментарии, будет изложено в разделе, посвященном качеству кода.

### Строгий режим — "use strict"
На протяжении долгого времени JavaScript развивался без проблем с обратной совместимостью. Новые функции добавлялись в язык, в то время как старая функциональность не менялась.

Преимуществом данного подхода было то, что существующий код продолжал работать. А недостатком – что любая ошибка или несовершенное решение, принятое создателями JavaScript, застревали в языке навсегда.

Так было до 2009 года, когда появился ECMAScript 5 (ES5). Он добавил новые возможности в язык и изменил некоторые из существующих. Чтобы устаревший код работал, как и раньше, по умолчанию подобные изменения не применяются. Поэтому нам нужно явно их активировать с помощью специальной директивы: `"use strict"`.[^strict-mode]

#### «use strict»
Директива выглядит как строка: `"use strict"` или `'use strict'`. Когда она находится в начале скрипта, весь сценарий работает в «современном» режиме.

Например:
```js
"use strict";

// этот код работает в современном режиме
...
```

Совсем скоро мы начнём изучать функции (способ группировки команд), поэтому заранее отметим, что в начале большинства видов функций можно поставить `"use strict"`. Это позволяет включить строгий режим только в конкретной функции. Но обычно люди используют его для всего файла.

!!! attention "Убедитесь, что «use strict» находится в начале"
    Проверьте, что `"use strict"` находится в первой исполняемой строке скрипта, иначе строгий режим может не включиться.

    Здесь строгий режим не включён:
    ```js
    alert("some code");
    // "use strict" ниже игнорируется - он должен быть в первой строке

    "use strict";

    // строгий режим не активирован
    ```

    Над `"use strict"` могут быть записаны только комментарии.

!!! attention "Нет никакого способа отменить `use strict`"
    Нет директивы типа `"no use strict"`, которая возвращала бы движок к старому поведению.

    Как только мы входим в строгий режим, отменить это невозможно.

#### Консоль браузера
В дальнейшем, когда вы будете использовать консоль браузера для тестирования функций, обратите внимание, что `use strict` по умолчанию в ней выключен.

Иногда, когда `use strict` имеет значение, вы можете получить неправильные результаты.

Итак, как можно включить `use strict` в консоли?

Можно использовать <kbd>Shift⇧</kbd>+<kbd>Enter⏎</kbd> для ввода нескольких строк и написать в верхней строке `use strict`:
```js
'use strict'; <Shift+Enter для перехода на новую строку>
//  ...ваш код...
<Enter для запуска>
```

В большинстве браузеров, включая Chrome и Firefox, это работает.

Если этого не происходит, например, в старом браузере, есть некрасивый, но надежный способ обеспечить `use strict`. Поместите его в следующую обёртку:
```js
(function() {
  'use strict';

  // ...ваш код...
})()
```

#### Всегда ли нужно использовать «use strict»?
Вопрос кажется риторическим, но это не так.

Кто-то посоветует начинать каждый скрипт с `"use strict"`… Но есть способ покруче.

Современный JavaScript поддерживает «классы» и «модули» — продвинутые структуры языка (и мы, конечно, до них доберёмся), которые автоматически включают строгий режим. Поэтому в них нет нужды добавлять директиву `"use strict"`.

**Подытожим: пока очень желательно добавлять `"use strict"`; в начале ваших скриптов. Позже, когда весь ваш код будет состоять из классов и модулей, директиву можно будет опускать.**

Пока мы узнали о `use strict` только в общих чертах.

В следующих разделах, по мере расширения знаний о возможностях языка, мы яснее увидим отличия между строгим и стандартным режимом. К счастью, их не так много, и все они делают жизнь разработчика лучше.

Все примеры далее подразумевают исполнение в строгом режиме, за исключением случаев (очень редких), когда оговорено иное.

### Взаимодействие с пользователем
Так как мы будем использовать браузер как демо-среду, нам нужно познакомиться с несколькими функциями его интерфейса, а именно: `alert`, `prompt` и `confirm`.[^alert-prompt-confirm]

#### alert
С этой функцией мы уже знакомы. Она показывает сообщение и ждёт, пока пользователь нажмёт кнопку «ОК».

Например:
```js
alert("Hello");
```

Это небольшое окно с сообщением называется <dfn title="модальное окно">модальным окном</dfn>. Понятие *модальное* означает, что пользователь не может взаимодействовать с интерфейсом остальной части страницы, нажимать на другие кнопки и т.д. до тех пор, пока взаимодействует с окном. В данном случае – пока не будет нажата кнопка «OK».

#### prompt
Функция `prompt` принимает два аргумента:
```js
result = prompt(title, [default]);
```

Этот код отобразит модальное окно с текстом, полем для ввода текста и кнопками OK/Отмена.

- **`title`**

    Текст для отображения в окне.

- **`default`**

    Необязательный второй параметр, который устанавливает начальное значение в поле для текста в окне.

!!! info "Квадратные скобки в синтаксисе [...]"
    Квадратные скобки вокруг `default` в описанном выше синтаксисе означают, что параметр факультативный, необязательный.

Пользователь может напечатать что-либо в поле ввода и нажать OK. Введённый текст будет присвоен переменной `result`. Пользователь также может отменить ввод нажатием на кнопку «Отмена» или нажав на клавишу <kbd>Esc</kbd>. В этом случае значением `result` станет `null`.

Вызов `prompt` возвращает текст, указанный в поле для ввода, или `null, если ввод отменён пользователем.

Например:
```js
let age = prompt('Сколько тебе лет?', 100);

alert(`Тебе ${age} лет!`); // Тебе 100 лет!
```

!!! warning "Для IE: всегда устанавливайте значение по умолчанию"
    Второй параметр является необязательным, но если не указать его, то Internet Explorer вставит строку `"undefined"` в поле для ввода.

    Запустите код в Internet Explorer и посмотрите на результат:
    ```js
    let test = prompt("Test");
    ```

    Чтобы `prompt` хорошо выглядел в IE, рекомендуется всегда указывать второй параметр:
    ```js
    let test = prompt("Test", ''); // <-- для IE
    ```

#### confirm
Синтаксис:
```js
result = confirm(question);
```

Функция `confirm` отображает модальное окно с текстом вопроса `question` и двумя кнопками: OK и Отмена.

Результат – `true`, если нажата кнопка OK. В других случаях – `false`.

Например:
```js
let isBoss = confirm("Ты здесь главный?");

alert( isBoss ); // true, если нажата OK
```

#### Итого
Мы рассмотрели 3 функции браузера для взаимодействия с пользователем:

- **`alert`**

    показывает сообщение.

- **`prompt`**

    показывает сообщение и запрашивает ввод текста от пользователя. Возвращает напечатанный в поле ввода текст или `null`, если была нажата кнопка «Отмена» или <kbd>Esc</kbd> с клавиатуры.

- **`confirm`**

    показывает сообщение и ждёт, пока пользователь нажмёт OK или Отмена. Возвращает `true`, если нажата OK, и `false`, если нажата кнопка «Отмена» или <kbd>Esc</kbd> с клавиатуры.

Все эти методы являются модальными: останавливают выполнение скриптов и не позволяют пользователю взаимодействовать с остальной частью страницы до тех пор, пока окно не будет закрыто.

На все указанные методы распространяются два ограничения:

1. Расположение окон определяется браузером. Обычно окна находятся в центре.
2. Визуальное отображение окон зависит от браузера, и мы не можем изменить их вид.

Такова цена простоты. Есть другие способы показать более приятные глазу окна с богатой функциональностью для взаимодействия с пользователем, но если «навороты» не имеют значения, то данные методы работают отлично.

#### Задачи

##### Простая страница

Создайте страницу, которая спрашивает имя у пользователя и выводит его.

<details>
<summary>Решение</summary>

JavaScript-код:
```js
let name = prompt("Ваше имя?", "");
alert(name);
```

Вся страница:
```html
<!DOCTYPE html>
<html>
<body>

  <script>
    'use strict';

    let name = prompt("Ваше имя?", "");
    alert(name);
  </script>

</body>
</html>
```

### Внешние скрипты
В прошлой статье код javascript непосредственно определялся на веб-странице. Но есть еще один способ подключения кода JavaScript, который представляет вынесение кода во внешние файлы и их подключение с помощью тега `<script>`.

Таким образом, если у вас много JavaScript-кода, вы можете поместить его в отдельный файл.

#### Создание отдельного файла

Итак, в прошлой теме мы создали html-страницу *index.html*, которая находится в каталоге *app*. Теперь создадим в этом каталоге новый подкаталог. Назовем его *js*. Он будет предназначен для хранения файлов с кодом javascript. В этом подкаталоге создадим новый текстовый файл, который назовем *main.js*. Файлы с кодом javascript имеют расширение *.js*. То есть у нас получится следующая структура проекта в папке *app*:

![Структура программы на JavaScript](../img/1.3.png)

Откроем файл *main.js* в текстовом редакторе и определим в нем следующий код:
```js
document.body.innerHTML = "<h2>Первая программа на JavaScript</h2>"; // выводим заголовок
document.body.innerHTML += "Привет мир!";                            // выводим обычный текст
```

Здесь для добавления на веб-страницу некоторого содержимого применяется свойство `document.body.innerHTML`. Это свойство включает три компонента:

- **`document`**: представляет текущий документ HTML (грубо говоря, текущий файл html)

- **`body`**: представляет элемент `body` — основное содержимое текущего документа HTML, которое собственно мы и видим на веб-странице в браузере

- **`innerHTML`**: представляет код HTML элемента `body`

То есть свойство `document.body.innerHTML` фактически означает, что мы обращаемся к коду `html` элемента `body` на текущей html-странице. Но что мы с ним делаем? Возьмем первую строку
```js
document.body.innerHTML = "<h2>Первая программа на JavaScript</h2>";
```

Здесь мы передаем во внутренне содержимое элемента `body` заголовок `<h2>`.

Далее на второй строке мы добавляем к содержимому элемента `body` простой текст.

```js
document.body.innerHTML += "Привет мир!";
```

Для совместимости с кодировкой страницы *index.html* для файла с кодом javascript также желательно устанавливать кодировку utf-8. При работе в Visual Studio Code этот редактор автоматически устанавливает кодировку UTF-8.

#### Подключение внешнего файла

Теперь подключим этот файл на веб-страницу *index.html*:
```html
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>DevPM</title>
</head>
<body>
    <script src="js/main.js"></script>
</body>
</html>
```

Чтобы подключить файл с кодом javascript на веб-страницу, применяется также тег **`<script>`**, у которого устанавливается атрибут **`src`**. Этот атрибут указывает на путь к файлу скрипта. В нашем случае используется относительный путь. Так как веб-страница находится в одной папке с каталогом *js*, то в качестве пути мы можем написать *js/main.js*.

Также надо учитывать, что за открывающим тегом `script` должен обязательно следовать закрывающий `</script>`

И после открытия файла *index.html* в браузере отобразится сообщение:

![Подключение внешних скриптов javascript](../img/1.7.png)

Таким образом, файл скрипта можно подключить к HTML с помощью атрибута `src`:
```html
<script src="/path/to/script.js"></script>
```

Здесь `/path/to/script.js` – это абсолютный путь от корневой папки до необходимого файла. Корневой папкой может быть корень диска или корень сайта, в зависимости от условий работы сайта. Также можно указать относительный путь от текущей страницы. Например, `src="script.js"` или `src="./script.js"` будет означать, что файл "script.js" находится в текущей папке.

Можно указать и полный URL-адрес. Например:
```html
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.2.0/lodash.js"></script>
```

Для подключения нескольких скриптов можно использовать несколько тегов:
```html
<script src="/js/script1.js"></script>
<script src="/js/script2.js"></script>
…
```

!!! info "На заметку:"
    Как правило, только простейшие скрипты помещаются в HTML. Более сложные выделяются в отдельные файлы.

    Польза отдельных файлов в том, что браузер загрузит скрипт отдельно и сможет хранить его в [кеше](https://en.wikipedia.org/wiki/Web_cache).

    Другие страницы, которые подключают тот же скрипт, смогут брать его из кеша вместо повторной загрузки из сети. И таким образом файл будет загружаться с сервера только один раз.

    Это сокращает расход трафика и ускоряет загрузку страниц.

Таким образом, в отличие от определения кода javascript вынесение его во внешние файлы имеет ряд преимуществ:

- Мы можем повторно использовать один и тот же код на нескольких веб-страницах.

- Внешние файлы javascript бразуер может кэшировать, за счет этого при следующем обращении к странице браузер снижает нагрузка на сервер, а браузеру надо загрузить меньший объем информации.

- Код веб-страницы становится "чище". Он содержит только html-разметку, а код поведения хранится во внешних файлах. В итоге можно отделить работу по созданию кода html-страницы от написания кода javascript.

Поэтому, как правило, предпочтительнее использовать код javascript во внешних файлах, а не в прямых вставках на веб-страницу с помощью элемента script.

!!! warning "Если атрибут `src` установлен, содержимое тега `script` будет игнорироваться."
    В одном теге `<script>` нельзя использовать одновременно атрибут `src` и код внутри.

    Нижеприведённый пример не работает:
    ```html
    <script src="file.js">
    alert(1); // содержимое игнорируется, так как есть атрибут src
    </script>
    ```

    Нужно выбрать: либо внешний скрипт `<script src="…">`, либо обычный код внутри тега `<script>`.

    Вышеприведённый пример можно разделить на два скрипта:
    ```html
    <script src="file.js"></script>
    <script>
    alert(1);
    </script>
    ```

#### Асинхронная загрузка и отложенное выполнение
Нередко веб-страницы имеют сложную структуру, какие-то блоки на html-странице, где подключаются файлы javascript, формируются динамически, что может усложнять управление файлами javascript. И для управления загрузкой файла с кодом JavaScript браузер предоставляет два атрибута: **`async`** и **`defer`**.

Атрибут **`async`** гарантирует, что обработка HTML-кода не будет приостановлена, когда браузер встретит элемент `<script>`. Файл JavaScript загружается асинхронно (отсюда и название атрибута — `async`). В этом случае HTML-код продолжает обрабатываться до тех пор, пока не будет загружен соответствующий файл JavaScript. Когда будет загружен файл JavaScript, обработка HTML останавливается, и начинает выполняться загруженный файл JS. После выполнения кода JavaScript продолжается обработка HTML.

![Асинхронная загрузка файла JavaScript и атрибут async](../img/1.14.png)

Пример применения атрибута **`async`**:
```html
<script async src="js/main.js"></script>
```

Атрибут **`defer`** также гарантирует, что обработка HTML-кода не будет приостановлена. С другой стороны, исходный код JavaScript выполняется только после полной обработки HTML-кода. Таким образом, выполнение кода JavaScript откладывается (отсюда и название — `defer` в переводе на английский).[^1-4]

![Отложенное выполенние файла JavaScript и атрибут defer](../img/1.15.png)

Пример применения атрибута `defer`:
```html
<script defer src="js/main.js"></script>
```

#### Загрузка модулей
*[CORS]: Cross-Origin Resource Sharing

Для загрузки модулей применяется политика CORS. <dfn title="CORS">CORS</dfn> (*Cross-Origin Resource Sharing*, «совместное использование ресурсов между разными источниками») — это механизм безопасности браузеров, использующий HTTP-заголовки, который разрешает или блокирует запросы к ресурсам на домене, отличающемся от домена страницы. Он позволяет безопасно обмениваться данными, преодолевая политику ограничения домена (*Same-Origin Policy*), запрещающую междоменные AJAX-запросы по умолчанию. Если сервер не настроен на CORS, браузер заблокирует ответ, даже если запрос успешно дошел до сервера.

Всё это значит, что мы не можем просто кинуть в браузер html-страницу, которая подключает модуль. Модуль загружается с использованием протокола http/https. То есть страница html, которая загружает модуль, должна располагаться на каком-нибудь веб-сервере.

- Модули всегда выполняются в режиме `strict mode`.

- Модули по умолчанию загружаются асинхронно.

- Модули загружаются и выполняются только один раз.

- Модули позволяют использовать выражения `await` верхнего уровня без определения и вызова асинхронной функции.

- Модули могут импортировать функционал из других модулей и, в свою очередь, экспортировать свою функциональность в другие модули.

- Модули выполняются не в глобальном контексте, а в своей собственной области видимости. То есть переменные, константы, функции, классы и т.д., определенные внутри модуля, не доступны извне, пока они не будут явным образом экспортированы. А чтобы другой модуль мог их использовать, он должен их импортировать.

Модули будут рассмотрены подробно в соответствующем разделе.

### Источники информации
[^intro]: [Введение в JavaScript](https://learn.javascript.ru/intro)
[^manuals-specifications]: [Справочники и спецификации](https://learn.javascript.ru/manuals-specifications)
[^code-editors]: [Редакторы кода](https://learn.javascript.ru/code-editors)
[^devtools]: [Консоль разработчика](https://learn.javascript.ru/devtools)
[^hello-world]: [Привет, мир!](https://learn.javascript.ru/hello-world)
[^structure]: [Структура кода](https://learn.javascript.ru/structure)
[^1-1]: [Введение в JavaScript](https://metanit.com/web/javascript/1.1.php)
[^1.2]: [Первая программа на JavaScript](https://metanit.com/web/javascript/1.2.php)
[^1.3]: [Выполнение кода javascript](https://metanit.com/web/javascript/1.3.php)
[^1-4]: [Подключение внешнего файла JavaScript](https://metanit.com/web/javascript/1.4.php)
[^strict-mode]: [Строгий режим — "use strict"](https://learn.javascript.ru/strict-mode)
[^alert-prompt-confirm]: [Взаимодействие: alert, prompt, confirm](https://learn.javascript.ru/alert-prompt-confirm)
